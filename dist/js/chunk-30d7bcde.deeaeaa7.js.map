{"version":3,"sources":["webpack:///./src/views/MapView.vue?1e97","webpack:///./src/views/MapView.vue?a2ca","webpack:///./src/assets/js/objectsClustering.js","webpack:///src/views/MapView.vue","webpack:///./src/views/MapView.vue?0b28","webpack:///./src/views/MapView.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","staticStyle","attrs","center","_l","m","key","id","polygon","polygonOptions","on","$event","markerClicked","objectsToShow","_m","showTableView","object","gotoDetail","_s","name","year","substr","mass","recclass","reclat","reclong","_e","staticRenderFns","getClustersAPI","APIBaseUrl","AppToken","gridDensity","bins","Array","globLatMin","globLngMin","latRange","lngRange","latStep","lngStep","latIdx","lngIdx","latMin","latMax","lngMin","lngMax","position","lat","lng","objects","getBoundedAreaObjects","baseUrl","appToken","fetch","response","json","data","console","log","maxZoom","strokeColor","strokeWidth","strokeOpacity","fillColor","fillOpacity","computed","markers","paths","points","push","i","methods","then","window","location","href","$router","params","component"],"mappings":"yIAAA,yBAAoiB,EAAG,G,2CCAviB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,KAAK,CAACE,YAAY,oCAAoC,CAACN,EAAIO,GAAG,kCAAkCH,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,IAAI,CAACJ,EAAIO,GAAG,iFAAiFH,EAAG,UAAU,CAACI,YAAY,CAAC,OAAS,SAASC,MAAM,CAAC,GAAK,MAAM,OAAST,EAAIU,OAAO,KAAO,EAAE,cAAc,YAAYV,EAAIW,GAAIX,EAAW,SAAE,SAASY,GAAG,OAAOR,EAAG,cAAc,CAACS,IAAID,EAAEE,GAAGL,MAAM,CAAC,MAAQG,EAAEG,QAAQ,WAAY,EAAM,UAAW,EAAM,WAAY,EAAK,QAAUf,EAAIgB,gBAAgBC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOlB,EAAImB,cAAcP,UAAS,GAAIZ,EAAiB,cAAEI,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,IAAI,CAACK,MAAM,CAAC,KAAO,mBAAmBL,EAAG,MAAM,CAACE,YAAY,yBAAyBG,MAAM,CAAC,GAAK,oBAAoB,CAAER,KAAKmB,cAAoB,OAAEhB,EAAG,QAAQ,CAACE,YAAY,mBAAmB,CAACF,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACJ,EAAIO,GAAG,QAAQP,EAAIqB,GAAG,GAAGrB,EAAIqB,GAAG,GAAGrB,EAAIqB,GAAG,GAAGrB,EAAIqB,GAAG,GAAGjB,EAAG,KAAK,CAACJ,EAAIO,GAAG,iBAAiBH,EAAG,KAAK,CAACE,YAAY,6BAA6BW,GAAG,CAAC,MAAQ,SAASC,GAAQlB,EAAIsB,eAAgB,KAAS,CAACtB,EAAIO,GAAG,qBAAqBH,EAAG,QAAQJ,EAAIW,GAAIX,EAAiB,eAAE,SAASuB,GAAQ,OAAOnB,EAAG,KAAK,CAACS,IAAIU,EAAOT,GAAGR,YAAY,sBAAsBW,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOlB,EAAIwB,WAAWD,MAAW,CAACnB,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAGF,EAAOT,OAAOV,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAGF,EAAOG,SAAUH,EAAW,KAAEnB,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAGF,EAAOI,KAAKC,OAAO,EAAG,OAAOxB,EAAG,MAAMA,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAGF,EAAOM,SAASzB,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAGF,EAAOO,aAAa1B,EAAG,KAAK,CAACJ,EAAIO,GAAGP,EAAIyB,GAAG,IAAMF,EAAOQ,OAAS,MAAQR,EAAOS,QAAU,cAAa,KAAK5B,EAAG,MAAM,CAACA,EAAG,IAAI,CAACJ,EAAIO,GAAG,qCAAqCH,EAAG,SAAS,CAACE,YAAY,6BAA6BW,GAAG,CAAC,MAAQ,SAASC,GAAQlB,EAAIsB,eAAgB,KAAS,CAACtB,EAAIO,GAAG,wBAAwBP,EAAIiC,MAAM,QAC57DC,EAAkB,CAAC,WAAa,IAAIlC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,KAAK,CAACA,EAAG,OAAO,CAACJ,EAAIO,GAAG,aAAa,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,KAAK,CAACA,EAAG,OAAO,CAACJ,EAAIO,GAAG,aAAa,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,KAAK,CAACA,EAAG,OAAO,CAACJ,EAAIO,GAAG,iBAAiB,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,KAAK,CAACA,EAAG,OAAO,CAACJ,EAAIO,GAAG,kB,kCCDnf,SAAS4B,IAcd,IAXA,IAAIC,EAAa,gDACbC,EAAW,4BACXC,EAAc,GACdC,EAAO,IAAIC,MAAMF,EAAcA,GAC/BG,GAAc,GACdC,GAAc,IACdC,EAAW,IACXC,EAAW,IACXC,EAAUF,EAAWL,EACrBQ,EAAUF,EAAWN,EAEhBS,EAAS,EAAGA,EAAST,EAAaS,IACzC,IAAK,IAAIC,EAAS,EAAGA,EAASV,EAAaU,IAAU,CACnD,IAAIC,EAASR,EAAaM,EAASF,EAC/BK,EAAST,GAAcM,EAAS,GAAKF,EACrCM,EAAST,EAAaM,EAASF,EAC/BM,EAASV,GAAcM,EAAS,GAAKF,EAEzCP,EAAKQ,EAAST,EAAcU,GAAU,CACpCK,SAAU,CAERC,IAAKL,GAAUC,EAASD,GAAU,EAClCM,IAAKJ,GAAUC,EAASD,GAAU,GAEpCK,QAASC,EAAsBrB,EAAYC,EAAUY,EAAQC,EAAQC,EAAQC,GAC7ErC,QAAS,CAEP,CAAEuC,IAAKL,EAAQM,IAAKH,GACpB,CAAEE,IAAKL,EAAQM,IAAKJ,GACpB,CAAEG,IAAKJ,EAAQK,IAAKJ,GACpB,CAAEG,IAAKJ,EAAQK,IAAKH,KAK5B,OAAOb,E,SAGMkB,E,0GAAf,WAAqCC,EAASC,EAAUV,EAAQC,EAAQC,EAAQC,GAAhF,kHAGyBQ,MACnBF,EACE,gBACAC,EACA,wDACAR,EACA,IACAF,EACA,KACAE,EACA,IACAD,EACA,KACAE,EACA,IACAF,EACA,KACAE,EACA,IACAH,EACA,KACAE,EACA,IACAF,EACA,SA3BR,cAGQY,EAHR,gBA6BqBA,EAASC,OA7B9B,cA6BQC,EA7BR,yBA8BWA,GA9BX,4CAgCIC,QAAQC,IAAI,KAAMJ,UAhCtB,kBAiCW,IAjCX,0D,wBC6CA,OACEnC,KAAM,UACNqC,KAFF,WAGI,MAAO,CACLrD,OAAQ,CAAd,eACMY,eAAe,EACf4C,QAAS,EACT9C,cAAe,GACfJ,eAAgB,CACdmD,YAAa,OACbC,YAAa,GACbC,cAAe,GACfC,UAAW,MACXC,YAAa,MAInBC,SAAU,CACRC,QADJ,WAIM,OAAO,KAETC,MANJ,WASM,IADA,IAAN,KACA,8BACQC,EAAOC,KAAK3E,KAAKwE,QAAQI,GAAG9D,SAE9B,OAAO4D,IAGXG,QAAS,CACP3D,cADJ,SACA,cACMlB,KAAKqB,eAAgB,EAErBC,EAAOiC,QAAQuB,MAAK,SAA1B,GACQ,EAAR,mBAGMC,OAAOC,SAASC,KAAO,kBAEzB1D,WAVJ,SAUA,GAEMvB,KAAKkF,QAAQP,KAAK,CAChBlD,KAAM,SACN0D,OAAQ,CAAhB,cCpIiV,I,wBCQ7UC,EAAY,eACd,EACAtF,EACAmC,GACA,EACA,KACA,WACA,MAIa,aAAAmD,E","file":"js/chunk-30d7bcde.deeaeaa7.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapView.vue?vue&type=style&index=0&id=464b579f&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapView.vue?vue&type=style&index=0&id=464b579f&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mapView\"},[_c('h1',{staticClass:\"pageTitle pageBlock blockContent\"},[_vm._v(\"Meteorite landings locations\")]),_c('div',{staticClass:\"pageBlock\"},[_c('div',{staticClass:\"blockContent\"},[_c('p',[_vm._v(\" To view the meteorites fallen in area marked with the rectangle click it. \")]),_c('GmapMap',{staticStyle:{\"height\":\"500px\"},attrs:{\"id\":\"map\",\"center\":_vm.center,\"zoom\":3,\"map-type-id\":\"terrain\"}},_vm._l((_vm.markers),function(m){return _c('GmapPolygon',{key:m.id,attrs:{\"paths\":m.polygon,\"draggable\":false,\"editable\":false,\"clickable\":true,\"options\":_vm.polygonOptions},on:{\"click\":function($event){return _vm.markerClicked(m)}}})}),1),(_vm.showTableView)?_c('div',{staticClass:\"blockContent\"},[_c('a',{attrs:{\"name\":\"landingsTable\"}}),_c('div',{staticClass:\"scrollableTableWrapper\",attrs:{\"id\":\"mapObjectsTable\"}},[(this.objectsToShow.length)?_c('table',{staticClass:\"scrollableTable\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"ID\")]),_vm._m(0),_vm._m(1),_vm._m(2),_vm._m(3),_c('th',[_vm._v(\"Geolocation\")]),_c('th',{staticClass:\"closeTableButton clickable\",on:{\"click\":function($event){_vm.showTableView = false}}},[_vm._v(\"Close table\")])])]),_c('tbody',_vm._l((_vm.objectsToShow),function(object){return _c('tr',{key:object.id,staticClass:\"clickable clkDetail\",on:{\"click\":function($event){return _vm.gotoDetail(object)}}},[_c('td',[_vm._v(_vm._s(object.id))]),_c('td',[_vm._v(_vm._s(object.name))]),(object.year)?_c('td',[_vm._v(_vm._s(object.year.substr(0, 4)))]):_c('td'),_c('td',[_vm._v(_vm._s(object.mass))]),_c('td',[_vm._v(_vm._s(object.recclass))]),_c('td',[_vm._v(_vm._s(\"(\" + object.reclat + \"°, \" + object.reclong + \"°)\"))])])}),0)]):_c('div',[_c('p',[_vm._v(\"No meteorites fell in this area\")]),_c('button',{staticClass:\"closeTableButton clickable\",on:{\"click\":function($event){_vm.showTableView = false}}},[_vm._v(\"Hide message\")])])])]):_vm._e()],1)])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('th',[_c('span',[_vm._v(\"Name\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('th',[_c('span',[_vm._v(\"Year\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('th',[_c('span',[_vm._v(\"Mass (g)\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('th',[_c('span',[_vm._v(\"Recclass\")])])}]\n\nexport { render, staticRenderFns }","export function getClustersAPI() {\n  //loads clusters of meteorites from API by lat and lng\n  //clustering to rectangles, number given by gridDensity\n  var APIBaseUrl = \"https://data.nasa.gov/resource/gh4g-9sfh.json\";\n  var AppToken = \"HPAC32pmEmvpcMVl7ERlkV1xr\";\n  var gridDensity = 20;\n  var bins = new Array(gridDensity * gridDensity);\n  var globLatMin = -90.0;\n  var globLngMin = -180.0;\n  var latRange = 180.0;\n  var lngRange = 360.0;\n  var latStep = latRange / gridDensity;\n  var lngStep = lngRange / gridDensity;\n\n  for (let latIdx = 0; latIdx < gridDensity; latIdx++) {\n    for (let lngIdx = 0; lngIdx < gridDensity; lngIdx++) {\n      let latMin = globLatMin + latIdx * latStep;\n      let latMax = globLatMin + (latIdx + 1) * latStep;\n      let lngMin = globLngMin + lngIdx * lngStep;\n      let lngMax = globLngMin + (lngIdx + 1) * lngStep;\n\n      bins[latIdx + gridDensity * lngIdx] = {\n        position: {\n          //rectangle center\n          lat: latMin + (latMax - latMin) / 2,\n          lng: lngMin + (lngMax - lngMin) / 2,\n        },\n        objects: getBoundedAreaObjects(APIBaseUrl, AppToken, latMin, latMax, lngMin, lngMax),\n        polygon: [\n          //rectangle corners\n          { lat: latMin, lng: lngMax },\n          { lat: latMin, lng: lngMin },\n          { lat: latMax, lng: lngMin },\n          { lat: latMax, lng: lngMax },\n        ],\n      };\n    }\n  }\n  return bins;\n}\n\nasync function getBoundedAreaObjects(baseUrl, appToken, latMin, latMax, lngMin, lngMax) {\n  //load meteorites within the given rectangle from API --> returns promise\n  try {\n    let response = await fetch(\n      baseUrl +\n        \"?$$app_token=\" +\n        appToken +\n        \"&$where=within_polygon(geolocation, 'MULTIPOLYGON (((\" +\n        lngMin +\n        \" \" +\n        latMin +\n        \", \" +\n        lngMin +\n        \" \" +\n        latMax +\n        \", \" +\n        lngMax +\n        \" \" +\n        latMax +\n        \", \" +\n        lngMax +\n        \" \" +\n        latMin +\n        \", \" +\n        lngMin +\n        \" \" +\n        latMin +\n        \")))')\"\n    );\n    let data = await response.json();\n    return data;\n  } catch (error) {\n    console.log(error.response);\n    return [];\n  }\n}\n","<template>\n  <div class=\"mapView\">\n    <h1 class=\"pageTitle pageBlock blockContent\">Meteorite landings locations</h1>\n    <div class=\"pageBlock\">\n      <div class=\"blockContent\">\n        <p>\n          To view the meteorites fallen in area marked with the rectangle click\n          it.\n        </p>\n\n        <!-- Google maps map view API -->\n        <GmapMap id=\"map\" :center=\"center\" :zoom=\"3\" map-type-id=\"terrain\" style=\"height: 500px\">\n          <!-- polygons defining the regions -->\n          <GmapPolygon\n            :key=\"m.id\"\n            v-for=\"m in markers\"\n            :paths=\"m.polygon\"\n            :draggable=\"false\"\n            :editable=\"false\"\n            :clickable=\"true\"\n            :options=\"polygonOptions\"\n            @click=\"markerClicked(m)\"\n          ></GmapPolygon>\n        </GmapMap>\n\n        <!-- Table of meteorites -->\n        <div class=\"blockContent\" v-if=\"showTableView\">\n          <a name=\"landingsTable\" />\n          <div class=\"scrollableTableWrapper\" id=\"mapObjectsTable\">\n            <table class=\"scrollableTable\" v-if=\"this.objectsToShow.length\">\n              <thead>\n                <tr>\n                  <th>ID</th>\n                  <th>\n                    <span>Name</span>\n                  </th>\n                  <th>\n                    <span>Year</span>\n                  </th>\n                  <th>\n                    <span>Mass (g)</span>\n                  </th>\n                  <th>\n                    <span>Recclass</span>\n                  </th>\n                  <th>Geolocation</th>\n                  <th\n                    class=\"closeTableButton clickable\"\n                    v-on:click=\"showTableView = false\"\n                  >Close table</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr\n                  v-for=\"object in objectsToShow\"\n                  :key=\"object.id\"\n                  v-on:click=\"gotoDetail(object)\"\n                  class=\"clickable clkDetail\"\n                >\n                  <td>{{ object.id }}</td>\n                  <td>{{ object.name }}</td>\n                  <td v-if=\"object.year\">{{ object.year.substr(0, 4) }}</td>\n                  <td v-else></td>\n                  <td>{{ object.mass }}</td>\n                  <td>{{ object.recclass }}</td>\n                  <td>{{ \"(\" + object.reclat + \"°, \" + object.reclong + \"°)\" }}</td>\n                </tr>\n              </tbody>\n            </table>\n            <div v-else>\n              <p>No meteorites fell in this area</p>\n              <button\n                class=\"closeTableButton clickable\"\n                v-on:click=\"showTableView = false\"\n              >Hide message</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport * as clustering from \"../assets/js/objectsClustering.js\";\n\nexport default {\n  name: \"MapView\",\n  data() {\n    return {\n      center: { lat: 20.0, lng: 10.0 },\n      showTableView: false,\n      maxZoom: 7,\n      objectsToShow: [], //objects within the selected area\n      polygonOptions: {\n        strokeColor: \"#eee\",\n        strokeWidth: 0.7,\n        strokeOpacity: 0.5,\n        fillColor: \"000\",\n        fillOpacity: 0.2\n      }\n    };\n  },\n  computed: {\n    markers() {\n      // async load of meteorites clusters from API\n      // objects only promise !\n      return clustering.getClustersAPI();\n    },\n    paths() {\n      // path to draw the area polygons\n      let points = [];\n      for (let i = 0; i < this.markers.length; i++) {\n        points.push(this.markers[i].polygon);\n      }\n      return points;\n    }\n  },\n  methods: {\n    markerClicked(object) {\n      this.showTableView = true;\n      //resolve promise\n      object.objects.then(data => {\n        this.objectsToShow = data;\n      });\n      //scroll to table\n      window.location.href = \"#landingsTable\";\n    },\n    gotoDetail(object) {\n      //route to detail page on object click\n      this.$router.push({\n        name: \"Detail\",\n        params: { id: object.id }\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.closeTableButton {\n  background-color: #ba0404;\n  color: white;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapView.vue?vue&type=template&id=464b579f&scoped=true&\"\nimport script from \"./MapView.vue?vue&type=script&lang=js&\"\nexport * from \"./MapView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapView.vue?vue&type=style&index=0&id=464b579f&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"464b579f\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}